{"ast":null,"code":"// Copyright 2015 Joyent, Inc.\n\nmodule.exports = {\n  Verifier: Verifier,\n  Signer: Signer\n};\nvar nacl = require('tweetnacl');\nvar stream = require('stream');\nvar util = require('util');\nvar assert = require('assert-plus');\nvar Buffer = require('safer-buffer').Buffer;\nvar Signature = require('./signature');\nfunction Verifier(key, hashAlgo) {\n  if (hashAlgo.toLowerCase() !== 'sha512') throw new Error('ED25519 only supports the use of ' + 'SHA-512 hashes');\n  this.key = key;\n  this.chunks = [];\n  stream.Writable.call(this, {});\n}\nutil.inherits(Verifier, stream.Writable);\nVerifier.prototype._write = function (chunk, enc, cb) {\n  this.chunks.push(chunk);\n  cb();\n};\nVerifier.prototype.update = function (chunk) {\n  if (typeof chunk === 'string') chunk = Buffer.from(chunk, 'binary');\n  this.chunks.push(chunk);\n};\nVerifier.prototype.verify = function (signature, fmt) {\n  var sig;\n  if (Signature.isSignature(signature, [2, 0])) {\n    if (signature.type !== 'ed25519') return false;\n    sig = signature.toBuffer('raw');\n  } else if (typeof signature === 'string') {\n    sig = Buffer.from(signature, 'base64');\n  } else if (Signature.isSignature(signature, [1, 0])) {\n    throw new Error('signature was created by too old ' + 'a version of sshpk and cannot be verified');\n  }\n  assert.buffer(sig);\n  return nacl.sign.detached.verify(new Uint8Array(Buffer.concat(this.chunks)), new Uint8Array(sig), new Uint8Array(this.key.part.A.data));\n};\nfunction Signer(key, hashAlgo) {\n  if (hashAlgo.toLowerCase() !== 'sha512') throw new Error('ED25519 only supports the use of ' + 'SHA-512 hashes');\n  this.key = key;\n  this.chunks = [];\n  stream.Writable.call(this, {});\n}\nutil.inherits(Signer, stream.Writable);\nSigner.prototype._write = function (chunk, enc, cb) {\n  this.chunks.push(chunk);\n  cb();\n};\nSigner.prototype.update = function (chunk) {\n  if (typeof chunk === 'string') chunk = Buffer.from(chunk, 'binary');\n  this.chunks.push(chunk);\n};\nSigner.prototype.sign = function () {\n  var sig = nacl.sign.detached(new Uint8Array(Buffer.concat(this.chunks)), new Uint8Array(Buffer.concat([this.key.part.k.data, this.key.part.A.data])));\n  var sigBuf = Buffer.from(sig);\n  var sigObj = Signature.parse(sigBuf, 'ed25519', 'raw');\n  sigObj.hashAlgorithm = 'sha512';\n  return sigObj;\n};","map":{"version":3,"names":["module","exports","Verifier","Signer","nacl","require","stream","util","assert","Buffer","Signature","key","hashAlgo","toLowerCase","Error","chunks","Writable","call","inherits","prototype","_write","chunk","enc","cb","push","update","from","verify","signature","fmt","sig","isSignature","type","toBuffer","buffer","sign","detached","Uint8Array","concat","part","A","data","k","sigBuf","sigObj","parse","hashAlgorithm"],"sources":["/Users/mohitgupta/Downloads/orgs/Clone/inst/node_modules/sshpk/lib/ed-compat.js"],"sourcesContent":["// Copyright 2015 Joyent, Inc.\n\nmodule.exports = {\n\tVerifier: Verifier,\n\tSigner: Signer\n};\n\nvar nacl = require('tweetnacl');\nvar stream = require('stream');\nvar util = require('util');\nvar assert = require('assert-plus');\nvar Buffer = require('safer-buffer').Buffer;\nvar Signature = require('./signature');\n\nfunction Verifier(key, hashAlgo) {\n\tif (hashAlgo.toLowerCase() !== 'sha512')\n\t\tthrow (new Error('ED25519 only supports the use of ' +\n\t\t    'SHA-512 hashes'));\n\n\tthis.key = key;\n\tthis.chunks = [];\n\n\tstream.Writable.call(this, {});\n}\nutil.inherits(Verifier, stream.Writable);\n\nVerifier.prototype._write = function (chunk, enc, cb) {\n\tthis.chunks.push(chunk);\n\tcb();\n};\n\nVerifier.prototype.update = function (chunk) {\n\tif (typeof (chunk) === 'string')\n\t\tchunk = Buffer.from(chunk, 'binary');\n\tthis.chunks.push(chunk);\n};\n\nVerifier.prototype.verify = function (signature, fmt) {\n\tvar sig;\n\tif (Signature.isSignature(signature, [2, 0])) {\n\t\tif (signature.type !== 'ed25519')\n\t\t\treturn (false);\n\t\tsig = signature.toBuffer('raw');\n\n\t} else if (typeof (signature) === 'string') {\n\t\tsig = Buffer.from(signature, 'base64');\n\n\t} else if (Signature.isSignature(signature, [1, 0])) {\n\t\tthrow (new Error('signature was created by too old ' +\n\t\t    'a version of sshpk and cannot be verified'));\n\t}\n\n\tassert.buffer(sig);\n\treturn (nacl.sign.detached.verify(\n\t    new Uint8Array(Buffer.concat(this.chunks)),\n\t    new Uint8Array(sig),\n\t    new Uint8Array(this.key.part.A.data)));\n};\n\nfunction Signer(key, hashAlgo) {\n\tif (hashAlgo.toLowerCase() !== 'sha512')\n\t\tthrow (new Error('ED25519 only supports the use of ' +\n\t\t    'SHA-512 hashes'));\n\n\tthis.key = key;\n\tthis.chunks = [];\n\n\tstream.Writable.call(this, {});\n}\nutil.inherits(Signer, stream.Writable);\n\nSigner.prototype._write = function (chunk, enc, cb) {\n\tthis.chunks.push(chunk);\n\tcb();\n};\n\nSigner.prototype.update = function (chunk) {\n\tif (typeof (chunk) === 'string')\n\t\tchunk = Buffer.from(chunk, 'binary');\n\tthis.chunks.push(chunk);\n};\n\nSigner.prototype.sign = function () {\n\tvar sig = nacl.sign.detached(\n\t    new Uint8Array(Buffer.concat(this.chunks)),\n\t    new Uint8Array(Buffer.concat([\n\t\tthis.key.part.k.data, this.key.part.A.data])));\n\tvar sigBuf = Buffer.from(sig);\n\tvar sigObj = Signature.parse(sigBuf, 'ed25519', 'raw');\n\tsigObj.hashAlgorithm = 'sha512';\n\treturn (sigObj);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}