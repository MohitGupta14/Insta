{"ast":null,"code":"'use strict';\n\nvar uuid = require('uuid');\nvar CombinedStream = require('combined-stream');\nvar isstream = require('isstream');\nvar Buffer = require('safe-buffer').Buffer;\nfunction Multipart(request) {\n  this.request = request;\n  this.boundary = uuid();\n  this.chunked = false;\n  this.body = null;\n}\nMultipart.prototype.isChunked = function (options) {\n  var self = this;\n  var chunked = false;\n  var parts = options.data || options;\n  if (!parts.forEach) {\n    self.request.emit('error', new Error('Argument error, options.multipart.'));\n  }\n  if (options.chunked !== undefined) {\n    chunked = options.chunked;\n  }\n  if (self.request.getHeader('transfer-encoding') === 'chunked') {\n    chunked = true;\n  }\n  if (!chunked) {\n    parts.forEach(function (part) {\n      if (typeof part.body === 'undefined') {\n        self.request.emit('error', new Error('Body attribute missing in multipart.'));\n      }\n      if (isstream(part.body)) {\n        chunked = true;\n      }\n    });\n  }\n  return chunked;\n};\nMultipart.prototype.setHeaders = function (chunked) {\n  var self = this;\n  if (chunked && !self.request.hasHeader('transfer-encoding')) {\n    self.request.setHeader('transfer-encoding', 'chunked');\n  }\n  var header = self.request.getHeader('content-type');\n  if (!header || header.indexOf('multipart') === -1) {\n    self.request.setHeader('content-type', 'multipart/related; boundary=' + self.boundary);\n  } else {\n    if (header.indexOf('boundary') !== -1) {\n      self.boundary = header.replace(/.*boundary=([^\\s;]+).*/, '$1');\n    } else {\n      self.request.setHeader('content-type', header + '; boundary=' + self.boundary);\n    }\n  }\n};\nMultipart.prototype.build = function (parts, chunked) {\n  var self = this;\n  var body = chunked ? new CombinedStream() : [];\n  function add(part) {\n    if (typeof part === 'number') {\n      part = part.toString();\n    }\n    return chunked ? body.append(part) : body.push(Buffer.from(part));\n  }\n  if (self.request.preambleCRLF) {\n    add('\\r\\n');\n  }\n  parts.forEach(function (part) {\n    var preamble = '--' + self.boundary + '\\r\\n';\n    Object.keys(part).forEach(function (key) {\n      if (key === 'body') {\n        return;\n      }\n      preamble += key + ': ' + part[key] + '\\r\\n';\n    });\n    preamble += '\\r\\n';\n    add(preamble);\n    add(part.body);\n    add('\\r\\n');\n  });\n  add('--' + self.boundary + '--');\n  if (self.request.postambleCRLF) {\n    add('\\r\\n');\n  }\n  return body;\n};\nMultipart.prototype.onRequest = function (options) {\n  var self = this;\n  var chunked = self.isChunked(options);\n  var parts = options.data || options;\n  self.setHeaders(chunked);\n  self.chunked = chunked;\n  self.body = self.build(parts, chunked);\n};\nexports.Multipart = Multipart;","map":{"version":3,"names":["uuid","require","CombinedStream","isstream","Buffer","Multipart","request","boundary","chunked","body","prototype","isChunked","options","self","parts","data","forEach","emit","Error","undefined","getHeader","part","setHeaders","hasHeader","setHeader","header","indexOf","replace","build","add","toString","append","push","from","preambleCRLF","preamble","Object","keys","key","postambleCRLF","onRequest","exports"],"sources":["/Users/mohitgupta/Downloads/orgs/Clone/inst/node_modules/request/lib/multipart.js"],"sourcesContent":["'use strict'\n\nvar uuid = require('uuid')\nvar CombinedStream = require('combined-stream')\nvar isstream = require('isstream')\nvar Buffer = require('safe-buffer').Buffer\n\nfunction Multipart (request) {\n  this.request = request\n  this.boundary = uuid()\n  this.chunked = false\n  this.body = null\n}\n\nMultipart.prototype.isChunked = function (options) {\n  var self = this\n  var chunked = false\n  var parts = options.data || options\n\n  if (!parts.forEach) {\n    self.request.emit('error', new Error('Argument error, options.multipart.'))\n  }\n\n  if (options.chunked !== undefined) {\n    chunked = options.chunked\n  }\n\n  if (self.request.getHeader('transfer-encoding') === 'chunked') {\n    chunked = true\n  }\n\n  if (!chunked) {\n    parts.forEach(function (part) {\n      if (typeof part.body === 'undefined') {\n        self.request.emit('error', new Error('Body attribute missing in multipart.'))\n      }\n      if (isstream(part.body)) {\n        chunked = true\n      }\n    })\n  }\n\n  return chunked\n}\n\nMultipart.prototype.setHeaders = function (chunked) {\n  var self = this\n\n  if (chunked && !self.request.hasHeader('transfer-encoding')) {\n    self.request.setHeader('transfer-encoding', 'chunked')\n  }\n\n  var header = self.request.getHeader('content-type')\n\n  if (!header || header.indexOf('multipart') === -1) {\n    self.request.setHeader('content-type', 'multipart/related; boundary=' + self.boundary)\n  } else {\n    if (header.indexOf('boundary') !== -1) {\n      self.boundary = header.replace(/.*boundary=([^\\s;]+).*/, '$1')\n    } else {\n      self.request.setHeader('content-type', header + '; boundary=' + self.boundary)\n    }\n  }\n}\n\nMultipart.prototype.build = function (parts, chunked) {\n  var self = this\n  var body = chunked ? new CombinedStream() : []\n\n  function add (part) {\n    if (typeof part === 'number') {\n      part = part.toString()\n    }\n    return chunked ? body.append(part) : body.push(Buffer.from(part))\n  }\n\n  if (self.request.preambleCRLF) {\n    add('\\r\\n')\n  }\n\n  parts.forEach(function (part) {\n    var preamble = '--' + self.boundary + '\\r\\n'\n    Object.keys(part).forEach(function (key) {\n      if (key === 'body') { return }\n      preamble += key + ': ' + part[key] + '\\r\\n'\n    })\n    preamble += '\\r\\n'\n    add(preamble)\n    add(part.body)\n    add('\\r\\n')\n  })\n  add('--' + self.boundary + '--')\n\n  if (self.request.postambleCRLF) {\n    add('\\r\\n')\n  }\n\n  return body\n}\n\nMultipart.prototype.onRequest = function (options) {\n  var self = this\n\n  var chunked = self.isChunked(options)\n  var parts = options.data || options\n\n  self.setHeaders(chunked)\n  self.chunked = chunked\n  self.body = self.build(parts, chunked)\n}\n\nexports.Multipart = Multipart\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}