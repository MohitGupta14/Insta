{"ast":null,"code":"var util = require('util');\nvar Stream = require('stream').Stream;\nvar DelayedStream = require('delayed-stream');\nmodule.exports = CombinedStream;\nfunction CombinedStream() {\n  this.writable = false;\n  this.readable = true;\n  this.dataSize = 0;\n  this.maxDataSize = 2 * 1024 * 1024;\n  this.pauseStreams = true;\n  this._released = false;\n  this._streams = [];\n  this._currentStream = null;\n  this._insideLoop = false;\n  this._pendingNext = false;\n}\nutil.inherits(CombinedStream, Stream);\nCombinedStream.create = function (options) {\n  var combinedStream = new this();\n  options = options || {};\n  for (var option in options) {\n    combinedStream[option] = options[option];\n  }\n  return combinedStream;\n};\nCombinedStream.isStreamLike = function (stream) {\n  return typeof stream !== 'function' && typeof stream !== 'string' && typeof stream !== 'boolean' && typeof stream !== 'number' && !Buffer.isBuffer(stream);\n};\nCombinedStream.prototype.append = function (stream) {\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    if (!(stream instanceof DelayedStream)) {\n      var newStream = DelayedStream.create(stream, {\n        maxDataSize: Infinity,\n        pauseStream: this.pauseStreams\n      });\n      stream.on('data', this._checkDataSize.bind(this));\n      stream = newStream;\n    }\n    this._handleErrors(stream);\n    if (this.pauseStreams) {\n      stream.pause();\n    }\n  }\n  this._streams.push(stream);\n  return this;\n};\nCombinedStream.prototype.pipe = function (dest, options) {\n  Stream.prototype.pipe.call(this, dest, options);\n  this.resume();\n  return dest;\n};\nCombinedStream.prototype._getNext = function () {\n  this._currentStream = null;\n  if (this._insideLoop) {\n    this._pendingNext = true;\n    return; // defer call\n  }\n\n  this._insideLoop = true;\n  try {\n    do {\n      this._pendingNext = false;\n      this._realGetNext();\n    } while (this._pendingNext);\n  } finally {\n    this._insideLoop = false;\n  }\n};\nCombinedStream.prototype._realGetNext = function () {\n  var stream = this._streams.shift();\n  if (typeof stream == 'undefined') {\n    this.end();\n    return;\n  }\n  if (typeof stream !== 'function') {\n    this._pipeNext(stream);\n    return;\n  }\n  var getStream = stream;\n  getStream(function (stream) {\n    var isStreamLike = CombinedStream.isStreamLike(stream);\n    if (isStreamLike) {\n      stream.on('data', this._checkDataSize.bind(this));\n      this._handleErrors(stream);\n    }\n    this._pipeNext(stream);\n  }.bind(this));\n};\nCombinedStream.prototype._pipeNext = function (stream) {\n  this._currentStream = stream;\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    stream.on('end', this._getNext.bind(this));\n    stream.pipe(this, {\n      end: false\n    });\n    return;\n  }\n  var value = stream;\n  this.write(value);\n  this._getNext();\n};\nCombinedStream.prototype._handleErrors = function (stream) {\n  var self = this;\n  stream.on('error', function (err) {\n    self._emitError(err);\n  });\n};\nCombinedStream.prototype.write = function (data) {\n  this.emit('data', data);\n};\nCombinedStream.prototype.pause = function () {\n  if (!this.pauseStreams) {\n    return;\n  }\n  if (this.pauseStreams && this._currentStream && typeof this._currentStream.pause == 'function') this._currentStream.pause();\n  this.emit('pause');\n};\nCombinedStream.prototype.resume = function () {\n  if (!this._released) {\n    this._released = true;\n    this.writable = true;\n    this._getNext();\n  }\n  if (this.pauseStreams && this._currentStream && typeof this._currentStream.resume == 'function') this._currentStream.resume();\n  this.emit('resume');\n};\nCombinedStream.prototype.end = function () {\n  this._reset();\n  this.emit('end');\n};\nCombinedStream.prototype.destroy = function () {\n  this._reset();\n  this.emit('close');\n};\nCombinedStream.prototype._reset = function () {\n  this.writable = false;\n  this._streams = [];\n  this._currentStream = null;\n};\nCombinedStream.prototype._checkDataSize = function () {\n  this._updateDataSize();\n  if (this.dataSize <= this.maxDataSize) {\n    return;\n  }\n  var message = 'DelayedStream#maxDataSize of ' + this.maxDataSize + ' bytes exceeded.';\n  this._emitError(new Error(message));\n};\nCombinedStream.prototype._updateDataSize = function () {\n  this.dataSize = 0;\n  var self = this;\n  this._streams.forEach(function (stream) {\n    if (!stream.dataSize) {\n      return;\n    }\n    self.dataSize += stream.dataSize;\n  });\n  if (this._currentStream && this._currentStream.dataSize) {\n    this.dataSize += this._currentStream.dataSize;\n  }\n};\nCombinedStream.prototype._emitError = function (err) {\n  this._reset();\n  this.emit('error', err);\n};","map":{"version":3,"names":["util","require","Stream","DelayedStream","module","exports","CombinedStream","writable","readable","dataSize","maxDataSize","pauseStreams","_released","_streams","_currentStream","_insideLoop","_pendingNext","inherits","create","options","combinedStream","option","isStreamLike","stream","Buffer","isBuffer","prototype","append","newStream","Infinity","pauseStream","on","_checkDataSize","bind","_handleErrors","pause","push","pipe","dest","call","resume","_getNext","_realGetNext","shift","end","_pipeNext","getStream","value","write","self","err","_emitError","data","emit","_reset","destroy","_updateDataSize","message","Error","forEach"],"sources":["/Users/mohitgupta/Downloads/orgs/Clone/inst/node_modules/combined-stream/lib/combined_stream.js"],"sourcesContent":["var util = require('util');\nvar Stream = require('stream').Stream;\nvar DelayedStream = require('delayed-stream');\n\nmodule.exports = CombinedStream;\nfunction CombinedStream() {\n  this.writable = false;\n  this.readable = true;\n  this.dataSize = 0;\n  this.maxDataSize = 2 * 1024 * 1024;\n  this.pauseStreams = true;\n\n  this._released = false;\n  this._streams = [];\n  this._currentStream = null;\n  this._insideLoop = false;\n  this._pendingNext = false;\n}\nutil.inherits(CombinedStream, Stream);\n\nCombinedStream.create = function(options) {\n  var combinedStream = new this();\n\n  options = options || {};\n  for (var option in options) {\n    combinedStream[option] = options[option];\n  }\n\n  return combinedStream;\n};\n\nCombinedStream.isStreamLike = function(stream) {\n  return (typeof stream !== 'function')\n    && (typeof stream !== 'string')\n    && (typeof stream !== 'boolean')\n    && (typeof stream !== 'number')\n    && (!Buffer.isBuffer(stream));\n};\n\nCombinedStream.prototype.append = function(stream) {\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n\n  if (isStreamLike) {\n    if (!(stream instanceof DelayedStream)) {\n      var newStream = DelayedStream.create(stream, {\n        maxDataSize: Infinity,\n        pauseStream: this.pauseStreams,\n      });\n      stream.on('data', this._checkDataSize.bind(this));\n      stream = newStream;\n    }\n\n    this._handleErrors(stream);\n\n    if (this.pauseStreams) {\n      stream.pause();\n    }\n  }\n\n  this._streams.push(stream);\n  return this;\n};\n\nCombinedStream.prototype.pipe = function(dest, options) {\n  Stream.prototype.pipe.call(this, dest, options);\n  this.resume();\n  return dest;\n};\n\nCombinedStream.prototype._getNext = function() {\n  this._currentStream = null;\n\n  if (this._insideLoop) {\n    this._pendingNext = true;\n    return; // defer call\n  }\n\n  this._insideLoop = true;\n  try {\n    do {\n      this._pendingNext = false;\n      this._realGetNext();\n    } while (this._pendingNext);\n  } finally {\n    this._insideLoop = false;\n  }\n};\n\nCombinedStream.prototype._realGetNext = function() {\n  var stream = this._streams.shift();\n\n\n  if (typeof stream == 'undefined') {\n    this.end();\n    return;\n  }\n\n  if (typeof stream !== 'function') {\n    this._pipeNext(stream);\n    return;\n  }\n\n  var getStream = stream;\n  getStream(function(stream) {\n    var isStreamLike = CombinedStream.isStreamLike(stream);\n    if (isStreamLike) {\n      stream.on('data', this._checkDataSize.bind(this));\n      this._handleErrors(stream);\n    }\n\n    this._pipeNext(stream);\n  }.bind(this));\n};\n\nCombinedStream.prototype._pipeNext = function(stream) {\n  this._currentStream = stream;\n\n  var isStreamLike = CombinedStream.isStreamLike(stream);\n  if (isStreamLike) {\n    stream.on('end', this._getNext.bind(this));\n    stream.pipe(this, {end: false});\n    return;\n  }\n\n  var value = stream;\n  this.write(value);\n  this._getNext();\n};\n\nCombinedStream.prototype._handleErrors = function(stream) {\n  var self = this;\n  stream.on('error', function(err) {\n    self._emitError(err);\n  });\n};\n\nCombinedStream.prototype.write = function(data) {\n  this.emit('data', data);\n};\n\nCombinedStream.prototype.pause = function() {\n  if (!this.pauseStreams) {\n    return;\n  }\n\n  if(this.pauseStreams && this._currentStream && typeof(this._currentStream.pause) == 'function') this._currentStream.pause();\n  this.emit('pause');\n};\n\nCombinedStream.prototype.resume = function() {\n  if (!this._released) {\n    this._released = true;\n    this.writable = true;\n    this._getNext();\n  }\n\n  if(this.pauseStreams && this._currentStream && typeof(this._currentStream.resume) == 'function') this._currentStream.resume();\n  this.emit('resume');\n};\n\nCombinedStream.prototype.end = function() {\n  this._reset();\n  this.emit('end');\n};\n\nCombinedStream.prototype.destroy = function() {\n  this._reset();\n  this.emit('close');\n};\n\nCombinedStream.prototype._reset = function() {\n  this.writable = false;\n  this._streams = [];\n  this._currentStream = null;\n};\n\nCombinedStream.prototype._checkDataSize = function() {\n  this._updateDataSize();\n  if (this.dataSize <= this.maxDataSize) {\n    return;\n  }\n\n  var message =\n    'DelayedStream#maxDataSize of ' + this.maxDataSize + ' bytes exceeded.';\n  this._emitError(new Error(message));\n};\n\nCombinedStream.prototype._updateDataSize = function() {\n  this.dataSize = 0;\n\n  var self = this;\n  this._streams.forEach(function(stream) {\n    if (!stream.dataSize) {\n      return;\n    }\n\n    self.dataSize += stream.dataSize;\n  });\n\n  if (this._currentStream && this._currentStream.dataSize) {\n    this.dataSize += this._currentStream.dataSize;\n  }\n};\n\nCombinedStream.prototype._emitError = function(err) {\n  this._reset();\n  this.emit('error', err);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}